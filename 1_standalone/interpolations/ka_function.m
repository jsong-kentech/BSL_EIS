function [ ka ] = ka_function(theta0a,T,cta)
% This function calculates the exchange current density of anode material
% data is from "n_am1_i0_22FKV08_HC2418-19.txt"
%% data [ x    i_0_preexp    Ea]
data = [0.0260	5.2409	46335.1441
        0.0355	6.8225	45806.3308
        0.0500	5.6412	46101.0405
        0.1000	5.2534	48947.0225
        0.1500	4.7060	47436.8552
        0.2000	4.5499	46885.3885
        0.2500	4.4496	47257.9886
        0.3000	4.4323	46309.7796
        0.3500	4.3071	46453.7477
        0.4000	4.1809	46670.6049
        0.4500	4.0315	47117.0978
        0.5000	4.0460	48181.2281
        0.5500	4.1046	49479.5374
        0.6000	4.3885	49910.9369
        0.6500	4.6790	50147.0535
        0.7000	4.9633	50505.7563
        0.7500	5.2551	50691.5592
        0.8000	5.5379	50969.5840
        0.8500	5.9387	49303.2659
        0.9000	6.8895	47111.8744
        0.9273	7.1964	51025.4440
        0.9410	9.0719	47564.0610];

%% Interpolation
    i0a_preexp = interp1(data(:,1),data(:,2),theta0a,'linear','extrap');
    Ea = interp1(data(:,1),data(:,3),theta0a,'linear','extrap');
    R = 8.314;
    F = 96487;
    ka = i0a_preexp*exp(-Ea/R*(1/T - 1/298.15))/F/cta;
    
end

